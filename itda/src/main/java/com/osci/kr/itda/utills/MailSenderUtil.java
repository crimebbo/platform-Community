package com.osci.kr.itda.utills;import com.osci.kr.itda.entity.Member;import lombok.AllArgsConstructor;import lombok.NoArgsConstructor;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.context.annotation.Bean;import org.springframework.mail.MailException;import org.springframework.mail.SimpleMailMessage;import org.springframework.mail.javamail.JavaMailSender;import org.springframework.mail.javamail.JavaMailSenderImpl;import org.springframework.mail.javamail.MimeMessageHelper;import org.springframework.mail.javamail.MimeMessagePreparator;import org.springframework.stereotype.Component;import org.springframework.stereotype.Service;import javax.mail.internet.MimeMessage;import javax.servlet.http.HttpServletRequest;import java.net.InetAddress;import java.util.Properties;@Componentpublic class MailSenderUtil {    @Autowired    private JavaMailSender javaMailSender;    @Autowired    private EamilTemplate eamilTemplate;    public void sinUpEmailSender(Member member, String token ,HttpServletRequest request){        try{        javax.mail.internet.MimeMessage mimeMessage = javaMailSender.createMimeMessage();        MimeMessageHelper helper = new MimeMessageHelper(mimeMessage,true,"UTF-8");        helper.setTo(member.getEmail());        helper.setSubject("YRBY 이메일 인증");        String getContextPath = request.getRequestURL().substring(0,request.getRequestURL().lastIndexOf("itda") + 4);        String url = getContextPath + "/api/v1/auth/check-email-token/" + token                +"/" + member.getEmail();        helper.setText(eamilTemplate.getAuthEmail(url),true);        javaMailSender.send(mimeMessage);        }catch (javax.mail.MessagingException ae){            ae.getMessage();        }    }    public void findByIdEmailSender(String email , String id) throws Exception{        javax.mail.internet.MimeMessage mimeMessage = javaMailSender.createMimeMessage();        MimeMessageHelper helper = new MimeMessageHelper(mimeMessage,true,"UTF-8");        helper.setTo(email);        helper.setSubject("[YRBY 아이디/비밀번호 찾기]");        //String findByid =  "아이디 : " +  id + "비밀번호 변경 : http://devitda.osci.kr:3000/auth/findAccount/password?id=" + id ;        helper.setText(eamilTemplate.getFindID(id) , true);        javaMailSender.send(mimeMessage);    }    @Bean    public JavaMailSenderImpl mailSender() {        JavaMailSenderImpl javaMailSender = new JavaMailSenderImpl();        javaMailSender.setProtocol("smtp");        javaMailSender.setHost("smtp.gmail.com");        javaMailSender.setPort(587);        javaMailSender.setUsername("jhpark@osci.kr");        javaMailSender.setPassword("3318##rere");        Properties props = javaMailSender.getJavaMailProperties();        props.put("mail.transport.protocol", "smtp");        props.put("mail.smtp.auth", "true");        props.put("mail.smtp.starttls.enable", "true");        props.put("mail.debug", "true");        return javaMailSender;    }}